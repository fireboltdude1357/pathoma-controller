---
phase: 02-web-controller-app
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can log in via Clerk and see authenticated UI"
    - "User can trigger play and pause commands via buttons"
    - "User can trigger seek forward/backward commands via buttons"
    - "User can trigger speed up/down commands via buttons"
  artifacts:
    - path: "app/page.tsx"
      provides: "Controller UI with auth-gated command buttons"
      min_lines: 80
      contains: "useMutation"
  key_links:
    - from: "app/page.tsx"
      to: "convex/commands.ts:send"
      via: "useMutation(api.commands.send)"
      pattern: "useMutation.*api\\.commands\\.send"
    - from: "app/page.tsx"
      to: "@clerk/nextjs"
      via: "SignedIn/SignedOut components"
      pattern: "SignedIn|SignedOut|UserButton"
---

<objective>
Build the web controller UI with Clerk authentication and command buttons for video playback control.

Purpose: Give authorized users a functional interface to send video commands (play, pause, seek, speed) that the Chrome extension will execute.
Output: Working page.tsx with auth-gated command buttons wired to Convex send mutation.
</objective>

<execution_context>
@/Users/tannersharon/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tannersharon/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@convex/schema.ts
@convex/commands.ts
@app/providers.tsx
@app/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create auth-aware controller layout</name>
  <files>app/page.tsx</files>
  <action>
Replace the placeholder page.tsx with a controller layout using Clerk components:

1. Import from @clerk/nextjs: SignedIn, SignedOut, SignInButton, UserButton
2. Add "use client" directive (required for Clerk components)
3. Create layout structure:
   - Header with app title and UserButton (shown when signed in)
   - Main content area that switches based on auth state:
     - SignedOut: Show sign-in prompt with SignInButton
     - SignedIn: Show controller interface (placeholder for now, filled in Task 2)
4. Use existing Tailwind classes for dark/light theme compatibility (already using zinc colors)
5. Keep the min-h-screen centered layout pattern from current page

Do NOT add the command buttons yet - Task 2 handles that.
  </action>
  <verify>
Run `npm run dev` and visit localhost:3000. Should see:
- Sign in prompt when not authenticated
- App title and UserButton when authenticated
  </verify>
  <done>
Page shows SignedOut state with sign-in button OR SignedIn state with UserButton depending on auth.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add command buttons with Convex mutations</name>
  <files>app/page.tsx</files>
  <action>
Add the video control buttons inside the SignedIn block:

1. Import from convex/react: useMutation
2. Import api from convex/_generated/api
3. Create sendCommand mutation: `const sendCommand = useMutation(api.commands.send)`
4. Create button grid with:
   - Play button: onClick={() => sendCommand({ type: "play" })}
   - Pause button: onClick={() => sendCommand({ type: "pause" })}
   - Seek backward buttons: 1s, 5s, 10s, 30s (each with amount: N)
   - Seek forward buttons: 1s, 5s, 10s, 30s (each with amount: N)
   - Speed down button (0.1x): onClick={() => sendCommand({ type: "speedDown", amount: 0.1 })}
   - Speed up button (0.1x): onClick={() => sendCommand({ type: "speedUp", amount: 0.1 })}
5. Style buttons with Tailwind:
   - Consistent button sizes (p-4 or similar)
   - Clear visual grouping (play/pause together, seek together, speed together)
   - Hover and active states
   - Use zinc colors to match existing theme
6. Add basic loading/disabled state during mutation (optional but nice)

Button layout suggestion:
- Row 1: Play, Pause
- Row 2: Seek back 1s, 5s, 10s, 30s
- Row 3: Seek forward 1s, 5s, 10s, 30s
- Row 4: Speed down, Speed up
  </action>
  <verify>
1. Run `npm run dev` and sign in
2. Open browser devtools Network tab
3. Click each button and verify Convex mutation is called
4. Check Convex dashboard - commands should appear in commands table
  </verify>
  <done>
All command buttons visible and functional. Clicking buttons creates commands in Convex database.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors
2. Page shows sign-in prompt when logged out
3. After sign-in, page shows controller buttons
4. Clicking any button sends command to Convex
5. Commands visible in Convex dashboard with correct type and amount
</verification>

<success_criteria>
- [ ] Page renders auth-aware layout (SignedIn/SignedOut)
- [ ] All 12 command buttons visible when authenticated (play, pause, 4x seek back, 4x seek forward, 2x speed)
- [ ] Each button correctly calls sendCommand with proper type and amount
- [ ] Commands appear in Convex dashboard when buttons clicked
</success_criteria>

<output>
After completion, create `.planning/phases/02-web-controller-app/02-01-SUMMARY.md`
</output>
